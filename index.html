<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ç†ç§‘ â—‹Ã— ã‚¯ã‚¤ã‚º</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: sans-serif; background:#f4f6f8; text-align:center; margin:0; }
.card { background:#fff; padding:24px; margin:20px auto; max-width:640px; border-radius:12px; }
button { font-size:20px; padding:12px 32px; margin:10px; }
#result { font-size:20px; margin-top:10px; }
#explanation { margin-top:12px; color:#333; }
</style>
</head>
<body>
<div class="card" id="game">
  <h2 id="count">èª­ã¿è¾¼ã¿ä¸­â€¦</h2>
  <h3 id="question"></h3>
  <button onclick="answer(true)">â—‹</button>
  <button onclick="answer(false)">Ã—</button>
  <div id="result"></div>
  <div id="explanation"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
let allQuestions = [];
let questions = [];
let current = 0;
let score = 0;

Papa.parse("questions.csv", {
  download: true,
  header: true,
  skipEmptyLines: true,
  complete: function(results) {
    allQuestions = results.data.map(row => ({
      q: row["å•é¡Œæ–‡"],
      a: row["æ­£è§£"] === "â—‹",
      e: row["è§£èª¬"] || ""
    }));
    startGame();
  },
  error: function() {
    document.getElementById("count").textContent = "èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ";
  }
});

function startGame() {
  current = 0;
  score = 0;
  questions = [...allQuestions].sort(() => Math.random() - 0.5).slice(0, 10);
  document.getElementById("game").innerHTML = `
    <h2 id="count"></h2>
    <h3 id="question"></h3>
    <button onclick="answer(true)">â—‹</button>
    <button onclick="answer(false)">Ã—</button>
    <div id="result"></div>
    <div id="explanation"></div>
  `;
  show();
}

function show() {
  document.getElementById("count").textContent = `ç¬¬ ${current + 1} å• / 10`;
  document.getElementById("question").textContent = questions[current].q;
  document.getElementById("result").textContent = "";
  document.getElementById("explanation").textContent = "";
}

function answer(choice) {
  if (choice === questions[current].a) {
    document.getElementById("result").textContent = "â­• æ­£è§£";
    score++;
  } else {
    document.getElementById("result").textContent = "âŒ ä¸æ­£è§£";
  }
  document.getElementById("explanation").textContent = questions[current].e;

  current++;
  if (current < 10) {
    setTimeout(show, 1200);
  } else {
    setTimeout(showResult, 1200);
  }
}

function showResult() {
  document.getElementById("game").innerHTML = `
    <h2>çµ‚äº†ï¼</h2>
    <p>å¾—ç‚¹ï¼š${score} / 10</p>
    <button onclick="startGame()">ğŸ” ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦</button>
  `;
}
</script>
</body>
</html>
